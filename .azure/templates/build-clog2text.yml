parameters:
  image: ''

jobs:
- job: build_clog2text
  displayName: Build Clog2Text
  pool:
    vmImage: ${{ parameters.image }}
  variables:
    runCodesignValidationInjection: false
  steps:
  - checkout: self
    submodules: true
  - task: UseDotNet@2
    displayName: Use .NET 6.0
    inputs:
      packageType: 'sdk'
      version: '6.0.x'
  - task: DotNetCoreCLI@2
    displayName: Build Clog
    inputs:
      command: 'build'
      projects: 'submodules/clog/clog.sln'

  - task: CopyFiles@2
    displayName: Move Nuget Artifacts
    inputs:
      sourceFolder: submodules/clog/src/nupkg
      contents: '**/!(*.ilk|*.cer|*.exp|*.lastcodeanalysissucceeded)'
      targetFolder: $(Build.ArtifactStagingDirectory)/bin

  - template: ./upload-artifacts.yml
