# Uploads the build artifacts for a single build configuration.

steps:
- task: CopyFiles@2
  displayName: Move Build Artifacts
  inputs:
    sourceFolder: artifacts/bin
    contents: '**/!(*.ilk|*.cer|*.exp|*.lastcodeanalysissucceeded)'
    targetFolder: $(Build.ArtifactStagingDirectory)/bin

- task: DeleteFiles@1
  displayName: Clear Artifacts
  condition: succeededOrFailed()
  inputs:
    contents: '**/artifacts/bin/*'

- task: PublishBuildArtifacts@1
  displayName: Upload Build Artifacts
  inputs:
    artifactName: artifacts
    pathToPublish: $(Build.ArtifactStagingDirectory)
    parallel: true

- task: DeleteFiles@1
  displayName: Clear Staging
  inputs:
    contents: $(Build.ArtifactStagingDirectory)/*
