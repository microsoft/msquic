# Creates the Windows OS build package.

jobs:
- job: git_push
  displayName: Git push to OS Repo
  pool:
    vmImage: windows-2019
  variables:
  - name: runCodesignValidationInjection
    value: false
  - group: VPackDeploymentKeys
  steps:
  - download: current
    artifact: package
    patterns: |
      msquic.man
      GitCheckin.json

  - task: PkgESFCIBGit@12
    displayName: 'Package ES - Submit Files to Git'
    inputs:
      configPath: 'artifacts/package/GitCheckin.json' # the path to the GitCheckin.json config file.
      artifactsDirectory: '$(Pipeline.Workspace)' # parent directory for the artifacts to submit to the destination repo.
      prTimeOut: 5
      paToken: '$(VPACK_PAT)' # "build token" from the previous wiki section. Ensure this secret isn't stored as plaintext.
